# ==============================================================================
# PARKBOARD - VERCEL PRODUCTION ENVIRONMENT VARIABLES
# ==============================================================================
# Template for Vercel deployment environment variables
#
# DO NOT commit .env.vercel.production with actual values to git!
#
# Usage:
#   1. Copy this file to .env.vercel.production
#   2. Fill in actual values
#   3. Run: ./scripts/deploy-vercel.sh
#
# The deployment script will automatically load variables from
# .env.vercel.production if it exists.
# ==============================================================================

# ==============================================================================
# DATABASE (REQUIRED)
# ==============================================================================
# Neon PostgreSQL connection string (MUST use pooled connection)
#
# Get from: https://console.neon.tech → Your Project → Connection Details
# Select: "Pooled connection" (contains -pooler in hostname)
#
# Format: postgresql://user:password@ep-xxx-pooler.region.aws.neon.tech/dbname?sslmode=require
#
# ⚠️  CRITICAL: Must use -pooler hostname for Vercel serverless compatibility
# ⚠️  Example: ep-cool-name-123456-pooler.us-east-1.aws.neon.tech

DATABASE_URL=postgresql://neondb_owner:YOUR_PASSWORD@ep-xxx-pooler.us-east-1.aws.neon.tech/neondb?sslmode=require

# ==============================================================================
# NEXTAUTH.JS CONFIGURATION (REQUIRED)
# ==============================================================================

# NextAuth Secret (32+ random characters)
# Generate with: openssl rand -base64 32
#
# ⚠️  SECURITY: Keep this secret! Never commit to git.
# ⚠️  Different value for production vs development

NEXTAUTH_SECRET=

# NextAuth URL (Application base URL)
# Will be set automatically after first deployment
# Format: https://your-app.vercel.app (or custom domain)
#
# NOTE: Leave empty on first deploy. Script will set after deployment.

NEXTAUTH_URL=

# Public Application URL (same as NEXTAUTH_URL)
# Used for client-side redirects and OAuth callbacks

NEXT_PUBLIC_APP_URL=

# ==============================================================================
# SUPABASE (LEGACY - Still Required for Query Layer)
# ==============================================================================
# Even though ParkBoard uses NextAuth for authentication,
# it still uses Supabase client SDK for database queries.
#
# Get from: https://supabase.com/dashboard → Settings → API
#
# NOTE: These can point to a different Supabase project than your database
# (database is on Neon, but queries use Supabase SDK for convenience)

# Supabase Project URL
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co

# Supabase Anonymous Key (public key - safe to expose)
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# ==============================================================================
# OPTIONAL - ERROR TRACKING
# ==============================================================================
# Sentry DSN for production error tracking
# Get from: https://sentry.io → Settings → Projects → Your Project → Client Keys

# NEXT_PUBLIC_SENTRY_DSN=https://xxx@xxx.ingest.sentry.io/xxx

# ==============================================================================
# OPTIONAL - RATE LIMITING (UPSTASH REDIS)
# ==============================================================================
# Upgrade from in-memory to persistent rate limiting
# Get from: https://console.upstash.com → Your Database → REST API
#
# Only needed if you need persistent rate limiting across deployments

# UPSTASH_REDIS_REST_URL=https://xxx.upstash.io
# UPSTASH_REDIS_REST_TOKEN=your-token

# ==============================================================================
# QUICK START GUIDE
# ==============================================================================
#
# FIRST-TIME DEPLOYMENT:
#
# 1. Create Neon database (https://neon.tech)
#    - Get pooled connection string
#    - Set DATABASE_URL above
#
# 2. Generate NextAuth secret:
#    openssl rand -base64 32
#    - Copy output to NEXTAUTH_SECRET above
#
# 3. Set Supabase variables (if using Supabase SDK):
#    - Get from Supabase dashboard
#    - Set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY
#
# 4. Run deployment:
#    ./scripts/deploy-vercel.sh
#
# 5. After first deploy:
#    - Note the Vercel URL (e.g., https://parkboard-xyz.vercel.app)
#    - Set NEXTAUTH_URL and NEXT_PUBLIC_APP_URL
#    - Redeploy: vercel --prod
#
# SUBSEQUENT DEPLOYMENTS:
#
# 1. Update code, commit changes
# 2. Run: ./scripts/deploy-vercel.sh
# 3. Script will use saved variables from .env.vercel.production
#
# ==============================================================================
# ENVIRONMENT VARIABLE REFERENCE
# ==============================================================================
#
# | Variable | Required | Purpose | Example |
# |----------|----------|---------|---------|
# | DATABASE_URL | Yes | Neon pooled connection | postgresql://...pooler... |
# | NEXTAUTH_SECRET | Yes | JWT signing key | (32-byte random string) |
# | NEXTAUTH_URL | After first deploy | App base URL | https://parkboard.app |
# | NEXT_PUBLIC_APP_URL | After first deploy | Client-side URL | https://parkboard.app |
# | NEXT_PUBLIC_SUPABASE_URL | Yes (legacy) | Supabase project | https://xxx.supabase.co |
# | NEXT_PUBLIC_SUPABASE_ANON_KEY | Yes (legacy) | Supabase anon key | eyJhbGci... |
# | NEXT_PUBLIC_SENTRY_DSN | No | Error tracking | https://xxx@sentry.io/xxx |
# | UPSTASH_REDIS_REST_URL | No | Persistent rate limiting | https://xxx.upstash.io |
# | UPSTASH_REDIS_REST_TOKEN | No | Redis auth token | (token string) |
#
# ==============================================================================
# SECURITY CHECKLIST
# ==============================================================================
#
# Before deploying to production:
#
# - [ ] DATABASE_URL uses -pooler connection (serverless compatible)
# - [ ] NEXTAUTH_SECRET is strong random value (32+ characters)
# - [ ] .env.vercel.production is in .gitignore (not committed)
# - [ ] Production variables different from development
# - [ ] All secrets rotated regularly (quarterly minimum)
# - [ ] No secrets exposed to client (NEXT_PUBLIC_* only for public data)
# - [ ] Vercel environment variables set via CLI or dashboard (not hardcoded)
#
# ==============================================================================
# TROUBLESHOOTING
# ==============================================================================
#
# Issue: "Invalid DATABASE_URL: Must use pooled connection"
# Solution: Ensure DATABASE_URL contains "-pooler" in hostname
#
# Issue: "Session not persisting after login"
# Solution: Verify NEXTAUTH_SECRET and NEXTAUTH_URL are set correctly
#
# Issue: "Database connection failed"
# Solution: Check DATABASE_URL format and Neon project is active
#
# Issue: "Rate limiting not working"
# Solution: In-memory rate limiter resets on redeploy (expected).
#           Upgrade to Upstash Redis for persistent limiting.
#
# For more help, see: docs/DEPLOYMENT_VERCEL_NEON_2025.md
#
# ==============================================================================
